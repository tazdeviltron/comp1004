<!doctype html>
<html>
<head>
    <title> Zombie shooter </title>
    <style>
        body {
            background-image: url('city.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: cover;
            color: white;
        }
    </style>
</head>
<!--Autor: Natasha
    Date written:13/12/23
    Version:V1 13/12/23
    Design of the page with register input and output of Soreboard-->
<body>
    <center>
        <h2> Scoreboard!</h2>
        <p id="demo"></p>
    </center>
    <h2>Register for game!</h2>
    <form onsubmit="myFunction(); return false">
        <label for="user">Username:</label>
        <input type="text" id="user" name="user" /><br><br>
        <label for="pass">Password:</label>
        <input type="password" id="pass" name="pass"><br><br>
        <label for="email">Email address:</label>
        <input type="email" id="email" name="email" /><br><br>
        <input type="submit" value="Submit" />
    </form>
    <h2>Update details</h2>
    <!--I need to have an interaction on what they want to update-->
    <input type="button" id="username" value="Update Username" onclick="btnUpdateUsername()" />
    <input type="button" id="password" value="Update Password" onclick="btnUpdatePassword()" />
    <input type="button" id="newemail" value="Update Email" onclick="btnUpdateEmail()" />
    <!--I need to make this div class hidden-->
    <div class="form-popup" id="username">
        <form action="/Users/natas/source/repos/comp1004/comp1004/index.html" class="form-container">
            <button type="submit" class="btn">Login</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
        </form>
    </div>
    <div class="form-popup" id="password">
        <form action="/Users/natas/source/repos/comp1004/comp1004/index.html" class="form-container">
            <button type="submit" class="btn">Login</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
        </form>
    </div>
    <div class="form-popup" id="newemail">
        <form action="/Users/natas/source/repos/comp1004/comp1004/index.html" class="form-container">
            <button type="submit" class="btn">Login</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
        </form>
    </div>
</body>
</html>

<script>
    //script to load input data
    registration_data = {};

    async function myFunction() {
	var db = JSON.parse(localStorage.getItem("database"));
	if (db === null) {
	db = [];
	}

        registration_data.username = document.getElementById("user").value;
        registration_data.password = await digestMessage(document.getElementById("pass").value);
        registration_data.email = document.getElementById("email").value;
//check if no other username is the same

//else
db.push(registration_data); //pushes data
localStorage.setItem("database", JSON.stringify(db)); //local storge



//could add check to see if strong password
    }
    function btnUpdateUsername(){
        document.getElementById("username").style.display = "block";
    }
    function closeForm() {
        document.getElementById("username").style.display = "none";
        document.getElementById("password").style.display = "none";
        document.getElementById("newemail").style.display = "none";
    }

    function btnUpdatePassword() {
        document.getElementById("password").style.display = "block";
    }
    function btnUpdateEmail() {
        document.getElementById("newemail").style.display = "block";
    }
	async function digestMessage(message) {
  const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgUint8); // hash the message
  const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
  const hashHex = hashArray
    .map((b) => b.toString(16).padStart(2, "0"))
    .join(""); // convert bytes to hex string
  return hashHex;
}
</script>
