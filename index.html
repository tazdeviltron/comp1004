<!doctype html>
<html>
<head>
    <title> Zombie shooter </title>
    <style>
        body {
            background-image: url('city.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: cover;
            color: white;
        }

		
    </style>
</head>
<!--Autor: Natasha
    Date written:13/12/23
    Version:V1 13/12/23
    Design of the page with register input and output of Soreboard-->
<body>
<input type="button" id="showreg" value ="Want to register?" onclick="btnshowreg()"/>
<input type="button" id="showlogin" value="Want to login?" onclick="btnshowlogin()"/>
<div id="login1" style="display:none"><label for="user1">Username:</label>
	<input type="text" id="user1" name="user1" />
	<label for="pass1">Password:</label>
	<input type="password" id="pass1" name="pass1">
    <input type="button" id="login" value="Login" onclick="btnLogin()" /></div>
    <center>
        <h2> Scoreboard!</h2>
		<table>
  <tr>
    <th>User</th>
    <th>Time(min)</th>
    <th>Level</th>
	<th>Score</th>
  </tr>
  <tr>
    <td>AlFu</td>
    <td>10:00</td>
    <td>7</td>
	<td>1001</td>
  </tr>
  <tr>
    <td>Nat</td>
    <td>9:55</td>
    <td>7</td>
	<td>999</td>
  </tr>
  <tr>
    <td>Lane</td>
	<td>9:50</td>
	<td> 7 </td>
	<td> 990 </td>
  </td>
</table>
        <p id="demo"></p>
    </center>
    <div id="reg" style="display:none"> <h2>Register for game!</h2>
    <form onsubmit="myFunction(); return false">
        <label for="user">Username:</label>
        <input type="text" id="user" name="user" /><br><br>
        <label for="pass">Password:</label>
        <input type="password" id="pass" name="pass"><br><br>
        <label for="email">Email address:</label>
        <input type="email" id="email" name="email" /><br><br>
        <input type="submit" value="Submit" />
    </form></div>
   <!--I need to make this div class hidden-->
    
</body>
</html>

<script>
    //script to load input data
    registration_data = {};
    async function myFunction() {
	var db = JSON.parse(localStorage.getItem("database"));
	if (db === null) {
	db = [];
	}

        registration_data.username = document.getElementById("user").value;
        registration_data.password = await digestMessage(document.getElementById("pass").value);
        registration_data.email = document.getElementById("email").value;
		flag = false;
//check if no other username is the same
    for(let i=0 ; i < db.length; i++){ // flag
 if (db[i].username == registration_data.username){
            flag = true;
                         break;
 //error
 }
	
}
        if (flag == false){
         db.push(registration_data); //pushes data
        localStorage.setItem("database", JSON.stringify(db));
 //local storge
}

else {
    //
	var usernameText = document.getElementById("user");
	var passwordText = document.getElementById("pass");
	var emailText = document.getElementById("email");
	usernameText.value = "";
	passwordText.value = "";
	emailText.value = "";
	alert("username has been taken");
}

    }
	

	async function digestMessage(message) {
  const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgUint8); // hash the message
  const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
  const hashHex = hashArray
    .map((b) => b.toString(16).padStart(2, "0"))
    .join(""); // convert bytes to hex string
  return hashHex;
}
async function btnLogin(){
//look though the reg and find email and pasword match

}
async function btnshowreg(){
var x = document.getElementById("reg");
if(x.style.display === "none"){
x.style.display ="inline-block";
}
else{
x.style.display ="none";
}
}
async function btnshowlogin(){
var y = document.getElementById("login1");
if(y.style.display ==="none"){
y.style.display="inline-block";
}
else{
y.style.display="none";
}
}
</script>
