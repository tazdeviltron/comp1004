<!doctype html>
<html>
<head>
    <title> Zombie shooter </title>
    <style>
        body {
            background-image: url('city.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: cover;
            color: white;
        }
    </style>
</head>
<!--Autor: Natasha
    Date written:13/12/23
    Version:V1 13/12/23
    Design of the page with register input and output of Soreboard-->
<body>
<label for="user1">Username:</label>
	<input type="text" id="user1" name="user1" />
	<label for="pass1">Password:</label>
	<input type="password" id="pass1" name="pass1">
    <input type="button" id="login" value="Login" onclick="btnLogin()" />
    <center>
        <h2> Scoreboard!</h2>
        <p id="demo"></p>
    </center>
    <h2>Register for game!</h2>
    <form onsubmit="myFunction(); return false">
        <label for="user">Username:</label>
        <input type="text" id="user" name="user" /><br><br>
        <label for="pass">Password:</label>
        <input type="password" id="pass" name="pass"><br><br>
        <label for="email">Email address:</label>
        <input type="email" id="email" name="email" /><br><br>
        <input type="submit" value="Submit" />
    </form>
   <!--I need to make this div class hidden-->
    
</body>
</html>

<script>
    //script to load input data
    registration_data = {};

    async function myFunction() {
	var db = JSON.parse(localStorage.getItem("database"));
	if (db === null) {
	db = [];
	}

        registration_data.username = document.getElementById("user").value;
        registration_data.password = await digestMessage(document.getElementById("pass").value);
        registration_data.email = document.getElementById("email").value;
		flag = false;
//check if no other username is the same
    for(let i=0 ; i < db.length; i++){ // flag
 if (db[i].username == registration_data.username){
            flag = true;
                         break;
 //error
 }
	
}
        if (flag == false){
         db.push(registration_data); //pushes data
        localStorage.setItem("database", JSON.stringify(db));
 //local storge
}

else {
    //
	var usernameText = document.getElementById("user");
	var passwordText = document.getElementById("pass");
	var emailText = document.getElementById("email");
	usernameText.value = "";
	passwordText.value = "";
	emailText.value = "";
	alert("username has been taken");
}

    }
	

	async function digestMessage(message) {
  const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgUint8); // hash the message
  const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
  const hashHex = hashArray
    .map((b) => b.toString(16).padStart(2, "0"))
    .join(""); // convert bytes to hex string
  return hashHex;
}
</script>
